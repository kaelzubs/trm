{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 30px; border-radius: 8px 8px 0 0; text-align: center; }
        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .content { background: #f8f9fa; padding: 30px; border-radius: 0 0 8px 8px; }
        .section { margin-bottom: 30px; }
        .section-title { font-size: 18px; font-weight: bold; color: #28a745; margin-bottom: 15px; border-bottom: 2px solid #28a745; padding-bottom: 10px; }
        .info-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #ddd; }
        .info-label { font-weight: bold; color: #555; }
        .info-value { color: #333; }
        .items-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        .items-table th { background: #28a745; color: white; padding: 12px; text-align: left; }
        .items-table td { padding: 10px 12px; border-bottom: 1px solid #ddd; }
        .items-table tr:hover { background: #f5f5f5; }
        .totals { background: white; padding: 15px; border-radius: 5px; margin-top: 15px; }
        .total-row { display: flex; justify-content: space-between; padding: 8px 0; font-size: 16px; }
        .grand-total { display: flex; justify-content: space-between; padding: 12px 0; font-size: 18px; font-weight: bold; color: #28a745; border-top: 2px solid #28a745; margin-top: 10px; }
        .address-box { background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #28a745; }
        .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 12px; color: #666; }
        .cta-button { display: inline-block; background: #28a745; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; margin: 15px 0; font-weight: bold; }
        .highlight { background: #fff3cd; padding: 10px; border-radius: 5px; margin: 15px 0; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚úì Order Confirmed</h1>
            <p>Thank you for your purchase!</p>
        </div>
        
        <div class="content">
            <!-- Greeting -->
            <p style="margin-bottom: 20px;">Hi {{ customer_name }},</p>
            
            <p style="margin-bottom: 20px;">
                We're thrilled to have you as our customer! Your order has been successfully placed and confirmed. 
                Below are the details of your order.
            </p>
            
            <!-- Order Details -->
            <div class="section">
                <div class="section-title">Order Details</div>
                <div class="info-row">
                    <span class="info-label">Order Number:</span>
                    <span class="info-value">#{{ order.pk }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Order Date:</span>
                    <span class="info-value">{{ order.created_at|date:"F j, Y \a\t g:i A" }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Status:</span>
                    <span class="info-value" style="color: #28a745; font-weight: bold;">{{ order.get_status_display }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Order Title:</span>
                    <span class="info-value">{{ order_title }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Items Ordered:</span>
                    <span class="info-value">{{ total_items }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Item Value:</span>
                    <span class="info-value">‚Ç¶{{ total_item_value|floatformat:2 }}</span>
                </div>
            </div>
            
            <!-- Order Items -->
            <div class="section">
                <div class="section-title">Items Ordered</div>
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Unit Price</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in order_items %}
                        <tr>
                            <td>{{ item.product.title }}</td>
                            <td>{{ item.quantity }}</td>
                            <td>‚Ç¶{{ item.unit_price|floatformat:2 }}</td>
                            <td>‚Ç¶{{ item.line_total|floatformat:2 }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                
                <!-- Order Summary -->
                <div class="totals">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span>‚Ç¶{{ order_subtotal|floatformat:2 }}</span>
                    </div>
                    <div class="total-row">
                        <span>Shipping:</span>
                        <span>‚Ç¶{{ shipping_cost|floatformat:2 }}</span>
                    </div>
                    <div class="grand-total">
                        <span>Total Amount:</span>
                        <span>‚Ç¶{{ order_total|floatformat:2 }}</span>
                    </div>
                </div>
            </div>
            
            <!-- Shipping Address -->
            <div class="section">
                <div class="section-title">Shipping Address</div>
                <div class="address-box">
                    <strong>{{ shipping_address.full_name }}</strong><br>
                    {{ shipping_address.line1 }}{% if shipping_address.line2 %}<br>{{ shipping_address.line2 }}{% endif %}<br>
                    {{ shipping_address.city }}{% if shipping_address.state %}, {{ shipping_address.state }}{% endif %} {{ shipping_address.postcode }}<br>
                    {{ shipping_address.get_country_display }}{% if shipping_address.phone %}<br>Phone: {{ shipping_address.phone }}{% endif %}
                </div>
            </div>
            
            <!-- Shipping Method -->
            <div class="section">
                <div class="section-title">Shipping Method</div>
                <div class="info-row">
                    <span class="info-label">Method:</span>
                    <span class="info-value">{{ order.get_shipping_method_display }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Estimated Delivery:</span>
                    <span class="info-value">5-10 business days</span>
                </div>
            </div>
            
            <!-- Next Steps -->
            <div class="section">
                <div class="section-title">What Happens Next?</div>
                <ol style="margin-left: 20px; line-height: 2;">
                    <li>We'll prepare your order for shipment</li>
                    <li>You'll receive a shipping notification with tracking information</li>
                    <li>Your items will be delivered to the address above</li>
                    <li>Confirm delivery and enjoy your purchase!</li>
                </ol>
            </div>
            
            <!-- Important Note -->
            <div class="highlight">
                <strong>üìß Keep this email:</strong> You'll need this order number (#{{ order.pk }}) for any inquiries about your order. 
                You can use it to track your shipment once it's on the way.
            </div>
            
            <!-- Support -->
            <div class="section">
                <div class="section-title">Need Help?</div>
                <p>
                    If you have any questions or concerns about your order, please don't hesitate to reach out:
                </p>
                <p style="margin-top: 10px;">
                    üìß Email: <a href="mailto:{{ support_email }}">{{ support_email }}</a><br>
                    üåê Website: <a href="#">TechRideMobile</a>
                </p>
            </div>
            
            <div class="footer">
                <p>{{ site_name }} | Order Management System</p>
                <p>This is an automated email. Please do not reply directly. Use the contact methods above for support.</p>
            </div>
        </div>
    </div>
</body>
</html>
